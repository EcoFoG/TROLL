---
title: "Sylviculture"
author: "Sylvain Schmitt sylvain.schmitt@agroparistech.fr"
date: '`r Sys.Date()`'
output:
  html_document:
    theme: journal
    toc: yes
    toc_depth: 5
    toc_float: yes
  pdf_document: default
  word_document: default
csl: /home/sylvain/Documents/Bibliography/csl/mee.csl
bibliography: /home/sylvain/Documents/Bibliography/library.bib
---

```{r config, message=FALSE, warning=FALSE, include=FALSE}
rm(list = ls()) ; invisible(gc())
library(knitr)
library(parallel)
library(TROLL)
library(RconTroll)
library(ggplot2)
library(cowplot)
library(plotly)
cores <- 15
opts_chunk$set(
  echo = F, message = F, warning = F, fig.height = 8, fig.width = 8,
    cache = T, cache.lazy = F)
```

# Introduction

In order to simulate sylviculture with TROLL we need to implement a new sylviculture module inside TROLL model code. After a litterature review it seems we can split sylviculture simulation between **logging** and **damages**. Each parts encompass differents sylviculture processes or effects:

- Logging
    - Species *composition, type, number, fuelwood*
    - Intensity *minimum and maximum extraction objectives*
    - Harvesting criteria *minimum and maximum diameter, harvesting order*
- Damages *Reduced impact logging (RIL)*
    - Directly hurted trees
        - By harvested tree
        - By skidding
    - Roads
    - Increased mortality for 10 years
    
We can model all this process and consequences of sylviculture in two ways:

- With an explicit modelling of the process *for well known process or deterministic events*
- By only taking into account the effect of the processes *e.g. a local increased mortality*

# Logging

To simulate selective logging we can use the selection harvesting algorithm from @Arii2008. To do that we need to build three parameters:

1. Probabilty for a tree to be cut $P_t$
2. Probability of cutting it's nearest neighbor $P_n$
3. Extraction objective(s) $O_t$

This algorithm is a nearest neighbor algorithm which simulates selective logging as a contagious spatial process thus similar to spread of fire in the forest. The tree with the highest probability to be cut $P_t$ is selected, then the algorithm compare the nearest neighbor probability of cutting $P_n$ to a random value between 0 and 1 to choose to cut it or not. If succesful the algorithm continue to spred the gap until the test is negative. When the test is negatvie the algorithm select the tree with the highest probability to be cut $P_t$ which is still alive. The algorithm run untill it reaches extraction objective(s) $O_t$.

**This algorithm was developped and test with a dataset from Haliburton, Canada. Consequently it is simulating correctly temperate selective logging which may highly differ from selective logging we may encounter in french Guiana. As a results we may have to adapt the  algorithm. A first major limit is to which extent can we allow the model to grow a gap (a limit gap size) ?**

Still if we want to adapt this algorithm, probability of cutting a tree $P_t$ will depend on species and harvesting criteria whereas extraction objective(s) $O_t$ will represents intensity (table 1). Extraction objective(s) $O_t$ can be based on one or multiple criteria encompassing number of trees harvested (N in $nb.ha^{-1}$), harvested basal area (BA in $m^2.ha^{-1}$), and canopy maximum opening (CO in $m^2.ha^{-1}$) (**Other criterion ?**). Probability to be cut $P_t$ will be computed for each tree regarding its species and diameter. Probability to be cut regarding the tree diameter ${P_t}_{dbh}$ will be specific and vary from 0 to 1 between minimum and maximum harvesting diameter of the species (resp. $dbh_{min}$ and $dbh_{max}$) (**Probability increase curve is to be defined**). Consequently $dbh_{min}$ and $dbh_{max}$ have to be precised for each harvested species in input. Probability to be cut regarding the tree species ${P_t}_{sp}$ will be proportional to defined proportion of species in harvesting. Consequently ${P_t}_{sp}$ have to be precised for each harvested species in input. Then probability to be cut $P_t$ can be defined as:
$$ P_t = {P_t}_{dbh} * {P_t}_{sp} = f(dbh_{min}, dbh_{max}) * {P_t}_{sp}$$

Table 1: Parameters for the algorithm. *Parameters with their names and related factors.*
```{r table}
tab1 <- data.frame(
  Parameter = c('$P_t$', '$O_t$'),
  Name = c('Probabilty to be cut', 'Extrcation objective(s)'),
  Factors = c('Species x Diameter', 'N, BA, Canopy opening, multicriteria')
  )
kable(tab1)
```

Consequently following the scheme we are able to simulate completely selective logging. We now need to model resulting damages.

# Damages

First few articles did not considered damages in sylviculture simulations [@Arii2008; @Tietjen2006]. So we may consider damages to be an option of sylviculture module inside TROLL (**?**).

## Harvested treefall

Harvested treefall can be considered random or oriented toward a direction of interest. Both @Huth2004 and @Ruger2008 assumed falling logged tree toward already logged patch for reduced impact logging method (RIL) against random direction for conventional sylviculture. Nevertheless in our context falling logged tree toward a direction of interest can be considered as dubious  (Traissac personnal communication) (**?**). In both cases we can use TROLL function `FallTree` in its original version for random fall or in an adapted version to explicitly model harvesting damages due to harvested treefall.

## Roads and skidding

Currently TROLL model assumed a flat environment. Consequently roads might be relatively easy to simulate. Roads and skidding are related and depend on sylviculture method (**To discuss**). All articles modelled roads and skidding not explicitly but as an increased mortality [@Huth2004; @Khler2004; @Ruger2008]. I argue that we can model both roads and skidding explicitly (**?**). Roads on a flat environment may be obvious and skidding damages depend on tree diameter and closest point on the closest road. Consequently, I think we can have a more precise sylviculture module by simulating all direct effects of sylviculture explicitly (i.e. logging, treefall, roads and skidding).

## Long term effects

Long term effects can be related to hurted tree, dead seed and seedlings and soil damages. Long term effects results in an increased mortality. It seems not possible to explicitly model those long term effects. All articles modelling damages only assumed a constant increased mortality for 10 years after the harvesting [@Huth2004; @Khler2004; @Ruger2008]. We can relate this to basal death rate $m$ inside TROLL and increase it by a factor after harvesting. Two aspects have to be defined the increased mortality intensity $I_m$ and duration $\Delta t_m$. Due to an increased mortality reducing in time, I suggest that the increased mortality intensity after logging is function of the time after logging $I_m = f(t_m)$ instead of constant. I suggest to fit it with Paracou data by measuring global difference of mortality before logging and after logging along time (**?**).

# Conclusion

Any points of previous reasoning can be discussed. Anyway I will just summarise points to discuss by paragraphs :

- Logging
    - *Use of @Arii2008 algorithm ?*
    - *Limit gap size ?*
    - *Extraction objectives criteria ?*
    - *Probability to be cut calculation ?*
- Damages
    - *Damages as an option ?*
    - Harvested treefall
        - *Explicit simulation of treefall ?*
        - *Random or directed treefall for harvested tree ?*
    - Roads and skidding
        - *Explicit simulation of road ?*
        - *Designed of road on a flat environment ?*
        - *Road and skidding related to sylviculture method (RIL, conventional...) ?*
        - *Explicit simulation of skidding ?*
    - Long term effects
        - *Implicit long term effects ?*
        - *Increased mortality decreasing in time ?*
        - *Fit a model with Paracou data ?*

# References
